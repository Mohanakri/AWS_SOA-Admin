1.Advance IAM:RBAC & ABAC

2.IAM Evaluation

3.Cross-Account Access:Hands_ON

4.MFA with the AWS CLI:Hands_ON

5.Access Evaluation Tools:Hands_ON

6.AWS Organizations and Control Tower

7.Organizations & SCP's:Hands_ON

8.Directory Services & Federation

9.Amazon Inspector & Trusted Advisor

10.Encryption Primer

11.Key Management Service (KMS)

12.Create KMS Key:Hands_ON

13.AWS KMS APS & CLI

14.AWS CloudHSM

15.AWS Certificate Manager

16.Managing ACM Certificates:Hands_ON

17.Secrets Managment

18.Secrets Manager with RDS and Lamda

19.AWS Security Hub & AWS Guarduty


======================================================================================
# 1.Advance IAM:RBAC & ABAC
In this lesson, two AWS IAM access control techniques are discussed: Role-Based Access Control (RBAC) and Attribute-Based Access Control (ABAC).
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/89c9c21f-f932-4016-88c5-5e8c0d8001d6)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/6ffd7296-7b2c-4118-8acd-54369b2be902)

**Role-Based Access Control (RBAC):**
- Users are grouped based on job roles, with policies attached to groups to define permissions.
- Permissions vary by job role (e.g., admin, development, operations) and follow the principle of least privilege.
- AWS managed policies can be used for common job roles, or custom policies can be created.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/0e0b8483-3e88-4e53-83e1-0728c0478fbc)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/6a163926-9661-4e09-bfeb-c465867d6480)

**Attribute-Based Access Control (ABAC):**
- Uses tags attached to IAM users and resources to control access.
- An example is given where a user (Dave) with a tag indicating his department (DB Admins) has permissions based on specific conditions.
- ABAC can enforce policies based on attributes like environment tags (e.g., production or development).
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/1ec3aa68-7681-49e4-84a2-102992e2ac01)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/79d49cb5-9e6d-415a-8a7f-98c57d983fb0)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/ae357390-9fe6-4f2d-aa3d-d4d81ee14267)

**Comparison of Identity-Based and Resource-Based Policies:**
- Identity-based policies are attached to users, groups, or roles.
- Resource-based policies are attached to AWS resources (e.g., S3 bucket policies) and include a principal element defining who has access.
- IAM policies include elements like effect (allow/deny), actions (specific API operations), and resources (which resources are affected).

**Examples of IAM Policies:**
- Policies can have conditions, such as restricting actions to a specific AWS region or IP address ranges.
- Understanding IAM policy syntax and structure is crucial for interpreting what actions are allowed or denied.

The lesson emphasizes the importance of knowing how to read and understand IAM policies, especially for AWS certification exams.
=========================================================================================
# 2.IAM Evaluation

In this lesson, the process of IAM policy evaluation in AWS is explained, focusing on how AWS decides whether to allow or deny access to a resource.

1. **Initial Decision**: Every request starts with an implicit deny.
2. **Policy Evaluation**: AWS evaluates applicable policies to look for an explicit deny. If found, the request is denied.
3. **Service Control Policy (SCP)**: Checks if the principal's account is part of an organization with an SCP. If no allow is found, the request is denied.
4. **Resource-Based Policy**: If the resource has a resource-based policy, AWS checks for an allow. If not found, it moves on.
5. **Identity-Based Policy**: If applicable, AWS checks the identity-based policy for an allow.
6. **Permissions Boundary**: If a permissions boundary applies, AWS checks for an allow within it.
7. **Session Policy**: For session principals, AWS checks for an allow in the session policy.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/f64e411b-7995-494c-8863-c71a81665099)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/46075713-f29f-43ee-8335-329d708d8563)

The process ensures that an explicit deny always overrides any allows. 

**Authorization Steps**:
1. **Authentication**: Verifying the identity of the requester.
2. **Request Context Formation**: Includes action, resource, principal, and environment data.
3. **Policy Evaluation**: AWS evaluates identity-based and resource-based policies to determine access.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/019db956-b8db-41bc-af1d-e5a51b8e2fbc)

**Types of Policies**:
- **Identity-Based Policies**: Attached to users, groups, and roles.
- **Resource-Based Policies**: Attached to resources.
- **Permissions Boundaries**: Set maximum permissions for identity-based policies.
- **Service Control Policies (SCPs)**: Set maximum permissions for organizations.
- **Session Policies**: Used with assumed role actions.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/91f4e4e1-18f1-4f0e-9ee3-28224f0de5dd)

**Effective Permissions**:
- The final permissions are the intersection of permissions allowed by identity-based policies, resource-based policies, permissions boundaries, and SCPs.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/04dc9850-1c37-4525-8aff-f8a7f7442dfd)

**Key Rules**:
- All requests are implicitly denied by default.
- Explicit allow overrides implicit deny.
- Permissions boundaries and SCPs can impose further restrictions.
- An explicit deny in any policy overrides all allows.
====================================================================================
# 3.Cross-Account Access:Hands_ON

In this lesson, you learn how to use cross-account access to assume a role and access an S3 bucket in AWS.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/c6d818e9-eeaf-45ed-bc68-38ba975800ec)

1. **Setup**:
   - **Accounts**: You need two AWS accounts. Account A has the S3 bucket and the role, while Account B has the user.
   - **S3 Bucket**: The bucket in Account A is private with no public access.

2. **Role and Permissions**:
   - **Role Creation**: In Account A, create a role that Account B can assume.
   - **Permissions Policy**: The role's permissions policy allows access to the S3 bucket.
   - **Trust Policy**: The trust policy includes an external ID, acting as a passphrase.

3. **Commands**:
   - **CLI Command**: Use the AWS CLI to assume the role with the `sts assume-role` command, including the external ID.
   - **Create Bucket**: Use the `AWS S3 MB` command to create a new bucket (e.g., "cross account test").
   - **Upload File**: Upload a file to the bucket.

4. **Role Setup**:
   - **IAM Role**: Create the IAM role in Account A, specifying Account B as the trusted entity and requiring the external ID.
   - **Policy Attachment**: Attach an inline policy to the role, granting necessary S3 actions (get object, put object, list bucket).

5. **Assuming the Role**:
   - **Switch Roles**: Switch roles to Account B and use CloudShell to run the `sts assume-role` command.
   - **Temporary Credentials**: The command provides temporary security credentials (access key ID, secret access key, session token).
   - **Configure Credentials**: Use `AWS configure set` to configure these credentials on the command line.

6. **Access S3 Bucket**:
   - **List Bucket**: Use the configured profile to list the contents of the S3 bucket in Account A, verifying cross-account access.
   - **Remove Credentials**: Deleting the credentials file and rerunning the list command without the profile results in access denied, showing the importance of the assumed role.

This process demonstrates how to assume a role using the AWS CLI, configure temporary credentials, and access resources in another AWS account securely.
======================================================================================
# 4.MFA with the AWS CLI:Hands_ON

This lesson demonstrates how to use multi-factor authentication (MFA) with the AWS Command Line Interface (CLI).

1. **Setup**:
   - **Virtual MFA Device**: Ensure you have a virtual MFA device configured in your AWS account.
   - **Serial Number**: Copy the serial number of the virtual MFA device from your account's security credentials.

2. **Get Session Token**:
   - **Command**: Use the `aws sts get-session-token` command to obtain temporary security credentials.
   - **Token Code**: Enter the current token code generated by the MFA device when prompted.

3. **Configure CLI**:
   - **Environment Variables**: Configure the CLI on your computer. If using Mac or Linux, use `export`; for Windows, use `set`.
   - **Credentials**: Copy the access key ID, secret access key, and session token into environment variables.

4. **Execution**:
   - **Verify Access**: Run an AWS CLI command (e.g., `aws s3 ls`) to verify access using the temporary credentials.
   - **Backup Credentials**: Backup your original credentials file and delete it to ensure you are using the temporary credentials.

5. **Undo Changes**:
   - **Unset Environment Variables**: Run commands to unset the environment variables to remove the temporary credentials.
   - **Restore Credentials**: Copy the backup credentials file back to the original location to restore access.

This process ensures secure access to AWS resources using MFA with the CLI by generating temporary credentials and configuring them as environment variables.
=======================================================================================
# 5.Access Evaluation Tools:Hands_ON

In this lesson, we explore several tools in the IAM Management Console to evaluate and manage user access in AWS accounts:

1. **Access Analyzer**:
   - **Enable Access Analyzer**: Quickly set it up with a single click.
   - **Findings**: Identifies potential access issues such as public access permissions on S3 buckets and IAM roles. 
   - **Details and Actions**: Provides detailed access levels and allows you to address any concerns.

2. **Credential Report**:
   - **Downloadable Report**: Provides information on user accounts, including creation dates, console access, password usage, MFA status, and more.
   - **Security Overview**: Helps in understanding user credentials from a security perspective.

3. **IAM Policy Simulator**:
   - **Simulate User Access**: Select a user, choose a service (e.g., EC2, S3), and specific actions to simulate and verify permissions.
   - **Results**: Shows allowed and denied actions based on the applied policies.

4. **Role Permissions Generator**:
   - **Generate Policy Based on CloudTrail Events**: For roles with multiple policies, this tool generates policies based on recent CloudTrail events.
   - **Customize and Apply Policies**: Review, edit, and apply generated policies to ensure roles have the necessary permissions.

These tools assist in analyzing, simulating, and managing access permissions to ensure secure and appropriate user and role access in AWS.
========================================================================================
# 6.AWS Organizations and Control Tower

This lesson covers AWS Organizations and AWS Control Tower, explaining their features and functionalities:
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/d6234032-35c3-4652-be8d-4f1021d65dc6)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/bb4d3b4c-2572-4f69-b09f-756895679a18)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/2d205952-93a4-44bb-af2b-bdd3631b0b73)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/148d58e9-6912-4bae-95d0-683489fa3e56)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/659ee708-8ab0-45b1-bc67-0bef75990dd8)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/efcb5f61-2347-4f5c-876f-daf160a4b595)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/ade9f65e-e9fb-43f1-a80a-e7b03198e56e)

### AWS Organizations:
1. **Overview**: Allows consolidation and centralized management of multiple AWS accounts.
2. **Feature Sets**:
   - **Consolidated Billing**: Combines billing across accounts.
   - **All Features**: Includes consolidated billing and additional management features.
3. **Structure**:
   - **Root Account**: Central management account.
   - **Organizational Units (OUs)**: Groups for organizing accounts and applying policies.
4. **Policies**:
   - **Service Control Policies (SCPs)**: Control the actions allowed within accounts.
   - **Tag Policies**: Enforce tagging standards.
5. **Billing**: One account handles billing for all linked accounts, itemized for cost allocation.
6. **Security and Compliance**:
   - **CloudTrail**: Enable auditing across accounts.
   - **Organizations API**: Automate account creation and management.
   - **IAM Identity Center**: Single sign-on solution.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/ae11a211-78b0-4889-9b72-7713e19f3ecc)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/6b7a7521-bd79-4fbb-92f4-20ab1e4d6552)

### AWS Control Tower:
1. **Overview**: Extends AWS Organizations with additional management features.
2. **Components**:
   - **Landing Zone**: A well-architected multi-account baseline.
   - **Guardrails**: Governance rules for compliance and security.
     - **Preventive Guardrails**: Disallow certain API actions using SCPs.
     - **Detective Guardrails**: Monitor compliance using AWS Config and Lambda.
   - **Account Factory**: Automates account creation.
   - **Centralized Logging**: Aggregates logs for better monitoring.
3. **Management**:
   - **Management Account**: Root account for control.
   - **Security OU**: Includes audit and log archive accounts.
   - **Sandbox OU**: For development and testing.
   - **Production OU**: For production environments.
   - **IAM Identity Center**: Centralized identity management and federated access.

### Key Concepts:
- **SCP Strategies**:
  - **Deny List Strategy**: Allows all actions by default, explicitly denies specific actions.
  - **Allow List Strategy**: Denies all actions by default, explicitly allows specific actions.
- **Inheritance**: Policies applied at higher levels affect all lower levels.
- **Role of Root User**: Can override guardrails in the management account.

By understanding these tools and concepts, you can effectively manage multiple AWS accounts, enforce security policies, and ensure compliance within your AWS environment.
========================================================================================
# 7.Organizations & SCP's:Hands_ON

In this lesson, the instructor demonstrates how to create an AWS organization and apply a Service Control Policy (SCP) to restrict certain actions in a development (DEV) account. The steps are as follows:
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/8449ea76-4721-45ef-ab06-c37ce594734a)

1. **Create an Organization**: 
   - Navigate to AWS Organizations and create a new organization with a default policy allowing all actions.

2. **Add a DEV Account**: 
   - Use the "Add an AWS account" option to create a DEV account, specifying a unique email and keeping the role as "OrganizationAccountAccessRole".

3. **Create an Organizational Unit (OU)**:
   - Create a new OU named "ou1" and move the DEV account into this OU.

4. **Enable Service Control Policies**:
   - Enable SCPs in the organization. The default "FullAWSAccess" policy allows all actions and is inherited by all accounts and OUs.

5. **Create and Attach a Custom SCP**:
   - Create a new SCP named "RequireT2Micro" that only allows launching T2 micro instances. Attach this policy to "ou1".

6. **Test the SCP**:
   - Switch roles into the DEV account using the "OrganizationAccountAccessRole".
   - Attempt to launch an EC2 instance of type T2 micro (which should succeed) and another type (which should fail, demonstrating the SCP's restriction).

7. **Switch Back to Original Account**:
   - After testing, switch back to the original management account.

The demonstration showcases how SCPs can effectively control and restrict API actions within specific AWS accounts, ensuring compliance with organizational policies.
=========================================================================================
# 8.Directory Services & Federation

In this lesson, you learn about AWS directory services and federation. The key points are:
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/5f85ff0f-f6f6-4d9a-91d3-ae305f6ed1fa)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/e77b8cc3-3d40-4aba-a700-e51984561a36)

1. **AWS Managed Microsoft Active Directory**:
   - This is a managed implementation of Microsoft AD on Windows server in AWS.
   - It provides highly available domain controllers (DCs).
   - You can connect your on-premises AD to AWS AD via VPN or direct connect, establishing a trust relationship.
   - Supports secure connections for Amazon EC2 Linux and Windows instances, Azure AD, and Office 365.
   - Allows for group policy application, single sign-on (SSO) to apps and services, and multi-factor authentication.
   - Suitable for organizations with over 5000 users or needing trust relationships with on-premises AD.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/1a01a6af-6311-430c-9007-faa4f08b5f39)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/860615a0-dd34-4497-8668-dbffa009576c)

2. **AD Connector**:
   - Links on-premises AD with AWS, enabling AWS applications to use on-premises AD credentials.
   - Facilitates seamless joining of Windows EC2 instances to on-premises AD.
   - Best for organizations preferring to use their existing AD with AWS services.
   - Comes in small (up to 500 users) and large (up to 5000 users) sizes, requiring VPN or direct connect.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/ce6e049e-a2c7-4f1b-bb9e-8ae1cb16c054)

3. **Identity Federation using SAML 2.0**:
   - Allows users to authenticate through on-premises AD to access AWS resources.
   - Uses Active Directory Federation Services (ADFS) to authenticate users and generate SAML assertions.
   - These assertions are used with AWS Security Token Service (STS) to obtain temporary credentials for accessing AWS services.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/0c67dcf8-4aed-4f67-aff1-5c872b501632)

4. **Web Identity Federation**:
   - Primarily used for mobile applications, allowing authentication through social identity providers (Amazon, Google, Facebook).
   - Utilizes STS to provide temporary security credentials for accessing AWS services.
   - AWS recommends using Cognito for web identity federation.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/d8e935b6-76a9-4350-9700-87c92c9eb2f0)

5. **IAM Identity Center (formerly AWS SSO)**:
   - Provides centralized permissions management and SSO.
   - Can integrate with various identity sources such as IAM Identity Center directory, Active Directory, and SAML 2.0 providers.
   - Enables SSO for AWS accounts and common business applications (e.g., Office 365, G Suite).
   - Allows users to log in with one set of credentials to access multiple resources.

This lesson covers how to set up and use these services to manage and federate identities within AWS, enabling secure and efficient access to AWS resources and applications.
========================================================================================
# 9.Amazon Inspector & Trusted Advisor

In this lesson, you learn about Amazon Inspector and AWS Trusted Advisor services.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/cbe5287a-2026-4642-b8c1-4d526f2999e1)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/5158ad82-9229-44e4-b7c8-366e22159e27)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/1b91a23d-6db8-4f1d-8b67-56b56082eea2)

1. **Amazon Inspector**:
   - **Purpose**: Runs security assessments on EC2 instances to identify vulnerabilities and exposures.
   - **Assessments**:
     - **Network Assessments**: Analyzes network configurations to identify reachable ports from outside the VPC. It does not require an agent.
     - **Host Assessments**: Identifies vulnerable software (CVEs) and checks compliance with CIS benchmarks. Requires an agent on the EC2 instances.
   - **Configuration**: Can be scheduled, and host assessments use the Systems Manager Run Command for agent installation.
   - **Pricing**: Based on the number of instance assessments.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/943711be-5844-40f8-affa-82f2e4a9d40b)

2. **AWS Trusted Advisor**:
   - **Purpose**: Provides real-time guidance to optimize AWS environments, focusing on cost reduction, performance improvement, and security enhancement.
   - **Areas of Guidance**:
     - **Cost Optimization**: Identifies potential savings.
     - **Performance**: Recommends ways to improve performance.
     - **Security**: Highlights security best practices.
     - **Fault Tolerance**: Advises on increasing fault tolerance.
     - **Service Limits**: Warns about approaching service limits.

Overall, these tools help ensure the security, efficiency, and cost-effectiveness of your AWS infrastructure.
========================================================================================
# 10.Encryption Primer

In this lesson, the focus is on the basics of encryption, covering the differences between various types of encryption used in AWS. The key points are:
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/0bdcca45-d6b0-4739-be64-b580ba981be5)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/4c5fed22-feee-4ab8-ad07-27cee1b378c3)

1. **Encryption in Transit vs. Encryption at Rest**:
   - **Encryption in Transit**: Encrypts data as it traverses a network, such as through an HTTPS connection. The data is encrypted while being transmitted, but may not be encrypted once it reaches its destination.
   - **Encryption at Rest**: Encrypts the actual data itself when it is stored. For example, data stored in Amazon S3 can be encrypted at rest.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/37588c53-f8e5-4c05-ba2b-2dd3933d5f9f)

2. **Asymmetric vs. Symmetric Encryption**:
   - **Asymmetric Encryption (Public Key Cryptography)**: Involves a pair of keysâ€”public and private. Data encrypted with the public key can only be decrypted with the private key, and vice versa. Examples include SSL/TLS and SSH.
   - **Symmetric Encryption**: Uses a single key for both encryption and decryption. The same key is used for both processes, unlike asymmetric encryption.

Understanding these fundamental concepts helps in grasping how AWS services like KMS keys, Cloud HSM, and AWS Certificate Manager utilize encryption.
========================================================================================
# 11.Key Management Service (KMS)

The lesson on AWS Key Management Service (KMS) explains its use in creating and managing encryption keys, both symmetric and asymmetric, which are securely stored in hardware security modules (HSM). 
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/4ed073ef-3eb6-49e7-8069-2cfdf81d153c)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/95b3fbc7-966f-423a-a76c-8c5cea0e8332)

Key points include:
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/c0093c17-1164-48d7-b3b5-488c758e3d94)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/74897c6a-48a4-48c5-8229-c05ed0e30bd6)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/9a90b766-9a86-4626-b0bb-968dbf522f93)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/b154a380-97c9-432b-8ef4-07681baaf5ef)

- **Types of Keys**:
  - **Customer Managed Keys**: Created and managed by developers.
  - **AWS Managed Keys**: Created and managed by AWS, integrated with various AWS services (e.g., SQS, ACM, EBS, FSX).

- **Key Material and Encryption**:
  - KMS keys can encrypt data up to 4KB. For larger data volumes, KMS generates data encryption keys (DEKs).
  - Keys can be stored outside of KMS using options like External Key Store (XKS) and Custom Key Store (CloudHSM).

- **Key Management**:
  - **AWS Managed Keys**: Integrated with many services but cannot be directly managed by users.
  - **Data Encryption Keys (DEKs)**: Used for encrypting large data volumes, managed outside of KMS.

![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/b154a380-97c9-432b-8ef4-07681baaf5ef)

- **Key Rotation**:
  - **Customer Managed Keys**: Optional yearly rotation.
  - **AWS Managed Keys**: Mandatory yearly rotation.
  - **AWS Owned Keys**: Fully managed by AWS, no user control.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/191d76cd-75ad-4a60-84f7-ab80f0691f21)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/63545990-03b1-4b4d-92e4-ba7013447780)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/3f1c40a7-39ab-4bc2-a814-1bce601a4f93)

- **Automatic vs. Manual Key Rotation**:
  - Automatic rotation changes key material without changing the key ID.
  - Manual rotation involves creating new keys and updating applications.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/e28ce7ab-b1c4-41a6-8b10-48ddd159c4c7)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/62dc78ac-0ec5-4a3b-902f-384f70d63109)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/f8e1f328-4c1d-46f4-b960-5cc120f8961e)

- **KMS Key Policies**:
  - Define management and usage permissions.
  - Separate administrative and usage permissions.
  - Use grants for temporary permissions.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/469067c6-a8be-435e-9b78-ea93187b8e24)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/7deddf14-bacb-4f82-a348-3ed0c346ec5d)

Additional exam tips cover:
- Sharing snapshots with another account requires decrypt and create grant permissions.
- Service condition keys can limit key usage to specific services.
- Cryptographic erasure involves deleting imported key material to prevent data decryption.
- Recognize the invalid key ID exception and understand differences between AWS managed and customer managed keys, particularly regarding key rotation.
=====================================================================================
# 12.Create KMS Key:Hands_ON

In this lesson, we learn how to create an AWS Key Management Service (KMS) key and use it to encrypt Elastic Block Store (EBS) volumes. Here are the steps covered:

1. **Create a KMS Key**:
   - Navigate to the Key Management Service in the AWS Management Console.
   - Create a symmetric key for encryption and decryption.
   - Assign an alias to the key (e.g., "my EBS key").
   - Set administrative permissions (e.g., your user account).
   - Assign key usage permissions, including permissions for the AWS service role for auto-scaling.
   - Review and finalize the key policy.

2. **Configure EC2 Instance with Encrypted EBS Volume**:
   - Go to the EC2 service and create a launch template.
   - Select the Amazon Linux 2 AMI, T2.micro instance type, and configure security groups.
   - Under storage settings, enable encryption for the root EBS volume using the newly created KMS key.
   - Create the launch template.

3. **Create an Auto Scaling Group**:
   - Set up an auto-scaling group using the launch template.
   - Configure subnets, and other settings, and launch the auto-scaling group.
   - Verify that the instance is launched with the encrypted volume using the specified KMS key.

4. **Verify Encryption**:
   - Check the EBS volume attached to the instance to ensure encryption is enabled and using the correct KMS key.

5. **Clean Up**:
   - Delete the auto-scaling group when finished.
   - Disable the KMS key and schedule it for deletion (minimum of seven days).

This process ensures that your EBS volumes are securely encrypted using a custom KMS key, and provides a mechanism for key management and deletion to maintain security.
====================================================================================
# 13.AWS KMS APS & CLI

In this lesson, we covered AWS KMS API and CLI commands, throttling mechanisms, and how caching can help manage these limits.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/a92fc033-59bf-4cc9-b0c3-28efc90861f8)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/b00182e2-a174-4c08-9d68-419c79ac8c68)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/af968aec-54ac-41ee-9ccd-5deb9f86fd33)

**Key API and CLI Commands:**

1. **Encrypt**: 
   - API: `encrypt`
   - CLI: `aws kms encrypt`
   - Encrypts plain text using a KMS key.

2. **Decrypt**:
   - Decrypts cipher text that was encrypted by a KMS key.

3. **Re-encrypt**:
   - Decrypts and re-encrypts data within KMS to change the KMS key or encryption context.

4. **Enable-key-rotation**:
   - Enables automatic rotation of the key material for a specified symmetric KMS key.

5. **GenerateDataKey**:
   - Generates a unique symmetric data key, returning both plain text and encrypted copies.

6. **GenerateDataKeyWithoutPlaintext**:
   - Generates a unique symmetric data key and returns only the encrypted copy.

7. **GenerateDataKeyPair** and **GenerateDataKeyPairWithoutPlaintext**:
   - Generates asymmetric data key pairs.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/b7801570-9c7a-49ae-9b67-5638bfa1bf52)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/055f4f5c-e266-401e-97f4-9bffafdfc80a)

**Throttling and Caching:**

- **Resource Quotas**: Limits on the number of resources you can create.
- **Request Quotas**: Limits on the rate of API actions like encrypt, decrypt, etc.
  - **Throttling Errors**: Occur when request quotas are exceeded, resulting in a `throttling exception` error.

**Strategies to Manage Throttling:**

1. **Backoff and Retry Strategy**:
   - Implement code that waits and retries requests to reduce frequency.

2. **Service Quota Increase**:
   - Request an increase if you need to consistently generate a large number of API actions.

3. **Data Key Caching**:
   - Store data keys and cryptographic material in a local cache using AWS Encryption SDK.
   - Useful for applications that can reuse data keys and need faster cryptographic operations.

This lesson provided essential knowledge for understanding KMS operations and managing potential throttling issues effectively.
====================================================================================
# 14.AWS CloudHSM

AWS CloudHSM is a service for creating and managing encryption keys using dedicated hardware devices within your VPC, offering a higher security level compared to the multi-tenant infrastructure of KMS. Key facts about CloudHSM include:
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/1ef9a20e-e2ca-4b2b-9e45-f4eb4615e17d)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/5bcbc525-dbc5-41dc-a35f-03df42f17ba6)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/11f98699-44e0-4c5d-8855-439ae7e0eaea)

- **Cloud-Based Hardware Security Module**: Provides hardware-based security, validated at FIPS 140-2 level 3.
- **Runs in VPC**: Offers control over encryption keys with AWS having no visibility into them.
- **Managed Service**: Automatically scales and provides full control over access.

**Use Cases for CloudHSM**:
1. Offloading SSL/TLS processing from web servers.
2. Protecting private keys from an issuing Certificate Authority (CA).
3. Storing master keys for transparent data encryption with Oracle databases.
4. Serving as a custom key store for KMS to retain control while integrating with AWS services.

**Comparison with KMS**:
- **Tenancy**: CloudHSM is single-tenant; KMS is multi-tenant.
- **Availability**: Both offer high availability, but CloudHSM provides more control.
- **Root of Trust**: Customer-managed in CloudHSM; AWS-managed in KMS.
- **FIPS 140-2 Compliance**: Level 3 for CloudHSM; level 2 and some level 3 operations for KMS.
- **Third-Party Support**: Broad support for CloudHSM but limited AWS service integration; KMS integrates broadly with AWS services.

CloudHSM offers enhanced security and control, making it suitable for organizations with stringent compliance or security requirements.
===================================================================================
# 15.AWS Certificate Manager
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/9cf00f36-a8da-4de1-b995-07412b6c1e45)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/f302581f-2153-47aa-a88e-deec71429538)

AWS Certificate Manager (ACM) is a service for issuing SSL/TLS certificates used for encryption in transit. Here are the key facts about ACM:

- **Certificate Creation and Management**: ACM can create, store, and renew SSL/TLS X.509 certificates, supporting single domains, multiple domains, and wildcards.
- **Integration with AWS Services**: Integrates with Elastic Load Balancing, Amazon CloudFront, Elastic Beanstalk, AWS Nitro Enclaves, and AWS CloudFormation.
- **Public and Private Certificates**: Issues public certificates signed by AWS Public Certificate Authority. Users can also create private certificate authorities within ACM to issue private certificates.
- **Importing Certificates**: Allows importing certificates from third-party issuers and key material to create certificates in AWS.

In summary, ACM is used for encryption in transit (SSL/TLS certificates), while AWS KMS or CloudHSM are used for encryption at rest (cryptographic keys). This distinction is crucial for understanding their roles in AWS security services.
===================================================================================
# 16.Managing ACM Certificates:Hands_ON

In this lesson, you learn how to use AWS Certificate Manager (ACM) to create and manage SSL/TLS certificates.

1. **Certificate Manager Console**: 
   - You can list, request, and import certificates.
   - To import, you need the certificate body, private key, and certificate chain.

2. **Requesting a Certificate**:
   - You need a Route 53 domain name.
   - Add fully qualified domain names (e.g., "example.com" and "www.example.com").
   - Two validation methods: DNS (recommended) and email.
   - For DNS validation, create CNAME records in your hosted zone to prove domain ownership.

3. **Process**:
   - Request a certificate and choose DNS validation.
   - AWS provides CNAME records to add to Route 53.
   - Use the "Create records in Route 53" option for automatic setup.
   - Once validated, the certificate is issued.

4. **Post-Validation**:
   - You can delete the CNAME records after validation.
   - The certificate can be used later with CloudFront and an Application Load Balancer.

The certificate is now ready for use in subsequent lessons with CloudFront and a load balancer.
========================================================================================
# 17.Secrets Managment

In this lesson, you'll learn about AWS Secrets Manager and AWS Systems Manager Parameter Store for managing access to secret information like passwords and database connection strings.

**AWS Secrets Manager:**
- Stores and rotates secrets safely without code deployments.
- Supports automatic credential rotation for Amazon RDS (MySQL, PostgreSQL, Aurora), Amazon Redshift, and DocumentDB.
- For other services, you can write your own Lambda function for rotation.
- Example: A Lambda function storing data in DynamoDB can retrieve the database connection string and password from Secrets Manager, which can automatically rotate credentials.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/16aa2268-5edc-4282-8c5f-b41108527515)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/7fc14274-8375-42fb-86b2-c61863fe2f49)

**AWS Systems Manager Parameter Store (SSM Parameter Store):**
- Provides secure hierarchical storage for configuration data and secrets.
- Highly scalable, available, and durable.
- Stores passwords, database strings, and license codes as parameter values, which can be plain text or encrypted.
- No native key rotation; you must use Lambda with your own code if needed.

![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/be1a16c5-2c2d-495b-9300-17ecb434f653)

**Comparison:**

- **Automatic Key Rotation:**
  - Secrets Manager: Built-in for some services, customizable with Lambda.
  - Parameter Store: No native rotation, customizable with Lambda.
  
- **Key Value Types:**
  - Secrets Manager: String or binary, always encrypted.
  - Parameter Store: String, string list, and secure string.
  
- **Storage Hierarchy:**
  - Secrets Manager: No hierarchical storage.
  - Parameter Store: Supports hierarchical storage.
  
- **Pricing:**
  - Secrets Manager: Pay per secret.
  - Parameter Store: Free standard tier, charges for advanced tier based on usage.
  ====================================================================================
# 18.Secrets Manager with RDS and Lamda

In this lesson, you learn how to use AWS Secrets Manager with an RDS database and a Lambda function to retrieve secrets. 

### Steps Covered:

1. **Create RDS Database:**
   - Go to RDS and create a MySQL database using the free tier.
   - Name it `sample-db` with the username `admin` and password `password`.
   - Set storage to 20 GB and create the database.

2. **Store Secrets in Secrets Manager:**
   - After the RDS database is ready, go to Secrets Manager.
   - Choose to store a new secret for an Amazon RDS database.
   - Select your database and enter the username and password.
   - Use the AWS managed key for encryption.
   - Name the secret `PROD/sample-db`.
   - Disable automatic rotation and store the secret.

3. **Retrieve Secret with Lambda:**
   - Download and use a provided `.js` file with the secret name and region specified.
   - Create a Lambda function named `SecretsTest` using Node.js 16.
   - Add necessary permissions to the Lambda execution role for accessing Secrets Manager and CloudWatch Logs.

4. **Test Lambda Function:**
   - Deploy the code in the Lambda function.
   - Add permissions to the Lambda execution role for Secrets Manager.
   - Create a test event and execute the function.
   - Check CloudWatch Logs to verify the secret retrieval and output.

5. **Cleanup:**
   - Delete the RDS database and the stored secret in Secrets Manager.

### Key Points:
- AWS Secrets Manager securely stores and rotates secrets.
- Secrets Manager supports automatic rotation for specific services.
- Lambda can be used to retrieve secrets from Secrets Manager and output them to CloudWatch Logs.
- Ensure the Lambda function has appropriate permissions to access Secrets Manager and CloudWatch Logs.
- Clean up resources after testing to avoid unnecessary charges.
=======================================================================================
# 19.AWS Security Hub & AWS Guarduty

In this lesson, we cover AWS Security Hub and AWS GuardDuty, two tools essential for managing your AWS account's security posture and alerting you to potential security issues.

![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/edcf3ee9-5874-4a42-9c48-df57b3e65c61)

### AWS Security Hub:
- **Purpose:** Provides cloud security posture management.
- **Features:**
  - Runs security best practice configuration checks for standards such as AWS Foundational Security Best Practices, CIS, and PCI DSS.
  - Aggregates alerts and provides automated remediation.
  - Integrations include Amazon EventBridge, AWS Systems Manager, AWS Organizations, and various ticketing, chat, incident management, GRC, SOAR, and SIEM tools.

### AWS GuardDuty:
- **Purpose:** Intelligent threat detection service.
- **Features:**
  - Detects account compromise, instance compromise, malicious reconnaissance, and bucket compromise.
  - Monitors events across services including CloudTrail management events, S3 data events, VPC flow logs, and DNS logs.

![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/cd7302b3-450e-4850-9418-244dfbb98444)

### Demonstration:
1. **Enabling Services:** Both services must be enabled in your account to start receiving results.
2. **Security Hub:**
   - Shows a breakdown of findings based on enabled standards (e.g., CIS, AWS Foundational Security Best Practices).
   - Provides a security score and details on critical, high, medium, and low findings.
   - Allows for viewing, addressing, and resolving specific security findings.
3. **GuardDuty:**
   - Displays findings related to potential security threats (e.g., IAM root credential usage).
   - Provides details such as access key ID, user, API actions, IP address, and actor location.
   - Shows data sources (e.g., CloudTrail, VPC flow logs, DNS logs) and estimated daily costs.
   - Includes malware scanning capability.

### Summary:
- **Security Hub** and **GuardDuty** are vital for identifying security issues and alerting to malicious activity.
- Enabling and configuring these tools is recommended for maintaining a secure AWS environment.
=========================================================================================
