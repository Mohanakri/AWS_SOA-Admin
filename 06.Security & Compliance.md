1.Advance IAM:RBAC & ABAC

2.IAM Evaluation

3.Cross-Account Access:Hands_ON

4.MFA with the AWS CLI:Hands_ON

5.Access Evaluation Tools:Hands_ON

6.AWS Organizations and Control Tower

7.Organizations & SCP's:Hands_ON

8.Directory Services & Federation

9.Amazon Inspector & Trusted Advisor

10.Encryption Primer

11.Key Management Service (KMS)







======================================================================================
# 1.Advance IAM:RBAC & ABAC
In this lesson, two AWS IAM access control techniques are discussed: Role-Based Access Control (RBAC) and Attribute-Based Access Control (ABAC).
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/89c9c21f-f932-4016-88c5-5e8c0d8001d6)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/6ffd7296-7b2c-4118-8acd-54369b2be902)

**Role-Based Access Control (RBAC):**
- Users are grouped based on job roles, with policies attached to groups to define permissions.
- Permissions vary by job role (e.g., admin, development, operations) and follow the principle of least privilege.
- AWS managed policies can be used for common job roles, or custom policies can be created.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/0e0b8483-3e88-4e53-83e1-0728c0478fbc)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/6a163926-9661-4e09-bfeb-c465867d6480)

**Attribute-Based Access Control (ABAC):**
- Uses tags attached to IAM users and resources to control access.
- An example is given where a user (Dave) with a tag indicating his department (DB Admins) has permissions based on specific conditions.
- ABAC can enforce policies based on attributes like environment tags (e.g., production or development).
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/1ec3aa68-7681-49e4-84a2-102992e2ac01)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/79d49cb5-9e6d-415a-8a7f-98c57d983fb0)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/ae357390-9fe6-4f2d-aa3d-d4d81ee14267)

**Comparison of Identity-Based and Resource-Based Policies:**
- Identity-based policies are attached to users, groups, or roles.
- Resource-based policies are attached to AWS resources (e.g., S3 bucket policies) and include a principal element defining who has access.
- IAM policies include elements like effect (allow/deny), actions (specific API operations), and resources (which resources are affected).

**Examples of IAM Policies:**
- Policies can have conditions, such as restricting actions to a specific AWS region or IP address ranges.
- Understanding IAM policy syntax and structure is crucial for interpreting what actions are allowed or denied.

The lesson emphasizes the importance of knowing how to read and understand IAM policies, especially for AWS certification exams.
=========================================================================================
# 2.IAM Evaluation

In this lesson, the process of IAM policy evaluation in AWS is explained, focusing on how AWS decides whether to allow or deny access to a resource.

1. **Initial Decision**: Every request starts with an implicit deny.
2. **Policy Evaluation**: AWS evaluates applicable policies to look for an explicit deny. If found, the request is denied.
3. **Service Control Policy (SCP)**: Checks if the principal's account is part of an organization with an SCP. If no allow is found, the request is denied.
4. **Resource-Based Policy**: If the resource has a resource-based policy, AWS checks for an allow. If not found, it moves on.
5. **Identity-Based Policy**: If applicable, AWS checks the identity-based policy for an allow.
6. **Permissions Boundary**: If a permissions boundary applies, AWS checks for an allow within it.
7. **Session Policy**: For session principals, AWS checks for an allow in the session policy.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/f64e411b-7995-494c-8863-c71a81665099)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/46075713-f29f-43ee-8335-329d708d8563)

The process ensures that an explicit deny always overrides any allows. 

**Authorization Steps**:
1. **Authentication**: Verifying the identity of the requester.
2. **Request Context Formation**: Includes action, resource, principal, and environment data.
3. **Policy Evaluation**: AWS evaluates identity-based and resource-based policies to determine access.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/019db956-b8db-41bc-af1d-e5a51b8e2fbc)

**Types of Policies**:
- **Identity-Based Policies**: Attached to users, groups, and roles.
- **Resource-Based Policies**: Attached to resources.
- **Permissions Boundaries**: Set maximum permissions for identity-based policies.
- **Service Control Policies (SCPs)**: Set maximum permissions for organizations.
- **Session Policies**: Used with assumed role actions.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/91f4e4e1-18f1-4f0e-9ee3-28224f0de5dd)

**Effective Permissions**:
- The final permissions are the intersection of permissions allowed by identity-based policies, resource-based policies, permissions boundaries, and SCPs.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/04dc9850-1c37-4525-8aff-f8a7f7442dfd)

**Key Rules**:
- All requests are implicitly denied by default.
- Explicit allow overrides implicit deny.
- Permissions boundaries and SCPs can impose further restrictions.
- An explicit deny in any policy overrides all allows.
====================================================================================
# 3.Cross-Account Access:Hands_ON

In this lesson, you learn how to use cross-account access to assume a role and access an S3 bucket in AWS.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/c6d818e9-eeaf-45ed-bc68-38ba975800ec)

1. **Setup**:
   - **Accounts**: You need two AWS accounts. Account A has the S3 bucket and the role, while Account B has the user.
   - **S3 Bucket**: The bucket in Account A is private with no public access.

2. **Role and Permissions**:
   - **Role Creation**: In Account A, create a role that Account B can assume.
   - **Permissions Policy**: The role's permissions policy allows access to the S3 bucket.
   - **Trust Policy**: The trust policy includes an external ID, acting as a passphrase.

3. **Commands**:
   - **CLI Command**: Use the AWS CLI to assume the role with the `sts assume-role` command, including the external ID.
   - **Create Bucket**: Use the `AWS S3 MB` command to create a new bucket (e.g., "cross account test").
   - **Upload File**: Upload a file to the bucket.

4. **Role Setup**:
   - **IAM Role**: Create the IAM role in Account A, specifying Account B as the trusted entity and requiring the external ID.
   - **Policy Attachment**: Attach an inline policy to the role, granting necessary S3 actions (get object, put object, list bucket).

5. **Assuming the Role**:
   - **Switch Roles**: Switch roles to Account B and use CloudShell to run the `sts assume-role` command.
   - **Temporary Credentials**: The command provides temporary security credentials (access key ID, secret access key, session token).
   - **Configure Credentials**: Use `AWS configure set` to configure these credentials on the command line.

6. **Access S3 Bucket**:
   - **List Bucket**: Use the configured profile to list the contents of the S3 bucket in Account A, verifying cross-account access.
   - **Remove Credentials**: Deleting the credentials file and rerunning the list command without the profile results in access denied, showing the importance of the assumed role.

This process demonstrates how to assume a role using the AWS CLI, configure temporary credentials, and access resources in another AWS account securely.
======================================================================================
# 4.MFA with the AWS CLI:Hands_ON

This lesson demonstrates how to use multi-factor authentication (MFA) with the AWS Command Line Interface (CLI).

1. **Setup**:
   - **Virtual MFA Device**: Ensure you have a virtual MFA device configured in your AWS account.
   - **Serial Number**: Copy the serial number of the virtual MFA device from your account's security credentials.

2. **Get Session Token**:
   - **Command**: Use the `aws sts get-session-token` command to obtain temporary security credentials.
   - **Token Code**: Enter the current token code generated by the MFA device when prompted.

3. **Configure CLI**:
   - **Environment Variables**: Configure the CLI on your computer. If using Mac or Linux, use `export`; for Windows, use `set`.
   - **Credentials**: Copy the access key ID, secret access key, and session token into environment variables.

4. **Execution**:
   - **Verify Access**: Run an AWS CLI command (e.g., `aws s3 ls`) to verify access using the temporary credentials.
   - **Backup Credentials**: Backup your original credentials file and delete it to ensure you are using the temporary credentials.

5. **Undo Changes**:
   - **Unset Environment Variables**: Run commands to unset the environment variables to remove the temporary credentials.
   - **Restore Credentials**: Copy the backup credentials file back to the original location to restore access.

This process ensures secure access to AWS resources using MFA with the CLI by generating temporary credentials and configuring them as environment variables.
=======================================================================================
# 5.Access Evaluation Tools:Hands_ON

In this lesson, we explore several tools in the IAM Management Console to evaluate and manage user access in AWS accounts:

1. **Access Analyzer**:
   - **Enable Access Analyzer**: Quickly set it up with a single click.
   - **Findings**: Identifies potential access issues such as public access permissions on S3 buckets and IAM roles. 
   - **Details and Actions**: Provides detailed access levels and allows you to address any concerns.

2. **Credential Report**:
   - **Downloadable Report**: Provides information on user accounts, including creation dates, console access, password usage, MFA status, and more.
   - **Security Overview**: Helps in understanding user credentials from a security perspective.

3. **IAM Policy Simulator**:
   - **Simulate User Access**: Select a user, choose a service (e.g., EC2, S3), and specific actions to simulate and verify permissions.
   - **Results**: Shows allowed and denied actions based on the applied policies.

4. **Role Permissions Generator**:
   - **Generate Policy Based on CloudTrail Events**: For roles with multiple policies, this tool generates policies based on recent CloudTrail events.
   - **Customize and Apply Policies**: Review, edit, and apply generated policies to ensure roles have the necessary permissions.

These tools assist in analyzing, simulating, and managing access permissions to ensure secure and appropriate user and role access in AWS.
========================================================================================
# 6.AWS Organizations and Control Tower

This lesson covers AWS Organizations and AWS Control Tower, explaining their features and functionalities:
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/d6234032-35c3-4652-be8d-4f1021d65dc6)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/bb4d3b4c-2572-4f69-b09f-756895679a18)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/2d205952-93a4-44bb-af2b-bdd3631b0b73)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/148d58e9-6912-4bae-95d0-683489fa3e56)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/659ee708-8ab0-45b1-bc67-0bef75990dd8)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/efcb5f61-2347-4f5c-876f-daf160a4b595)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/ade9f65e-e9fb-43f1-a80a-e7b03198e56e)

### AWS Organizations:
1. **Overview**: Allows consolidation and centralized management of multiple AWS accounts.
2. **Feature Sets**:
   - **Consolidated Billing**: Combines billing across accounts.
   - **All Features**: Includes consolidated billing and additional management features.
3. **Structure**:
   - **Root Account**: Central management account.
   - **Organizational Units (OUs)**: Groups for organizing accounts and applying policies.
4. **Policies**:
   - **Service Control Policies (SCPs)**: Control the actions allowed within accounts.
   - **Tag Policies**: Enforce tagging standards.
5. **Billing**: One account handles billing for all linked accounts, itemized for cost allocation.
6. **Security and Compliance**:
   - **CloudTrail**: Enable auditing across accounts.
   - **Organizations API**: Automate account creation and management.
   - **IAM Identity Center**: Single sign-on solution.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/ae11a211-78b0-4889-9b72-7713e19f3ecc)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/6b7a7521-bd79-4fbb-92f4-20ab1e4d6552)

### AWS Control Tower:
1. **Overview**: Extends AWS Organizations with additional management features.
2. **Components**:
   - **Landing Zone**: A well-architected multi-account baseline.
   - **Guardrails**: Governance rules for compliance and security.
     - **Preventive Guardrails**: Disallow certain API actions using SCPs.
     - **Detective Guardrails**: Monitor compliance using AWS Config and Lambda.
   - **Account Factory**: Automates account creation.
   - **Centralized Logging**: Aggregates logs for better monitoring.
3. **Management**:
   - **Management Account**: Root account for control.
   - **Security OU**: Includes audit and log archive accounts.
   - **Sandbox OU**: For development and testing.
   - **Production OU**: For production environments.
   - **IAM Identity Center**: Centralized identity management and federated access.

### Key Concepts:
- **SCP Strategies**:
  - **Deny List Strategy**: Allows all actions by default, explicitly denies specific actions.
  - **Allow List Strategy**: Denies all actions by default, explicitly allows specific actions.
- **Inheritance**: Policies applied at higher levels affect all lower levels.
- **Role of Root User**: Can override guardrails in the management account.

By understanding these tools and concepts, you can effectively manage multiple AWS accounts, enforce security policies, and ensure compliance within your AWS environment.
========================================================================================
# 7.Organizations & SCP's:Hands_ON

In this lesson, the instructor demonstrates how to create an AWS organization and apply a Service Control Policy (SCP) to restrict certain actions in a development (DEV) account. The steps are as follows:
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/8449ea76-4721-45ef-ab06-c37ce594734a)

1. **Create an Organization**: 
   - Navigate to AWS Organizations and create a new organization with a default policy allowing all actions.

2. **Add a DEV Account**: 
   - Use the "Add an AWS account" option to create a DEV account, specifying a unique email and keeping the role as "OrganizationAccountAccessRole".

3. **Create an Organizational Unit (OU)**:
   - Create a new OU named "ou1" and move the DEV account into this OU.

4. **Enable Service Control Policies**:
   - Enable SCPs in the organization. The default "FullAWSAccess" policy allows all actions and is inherited by all accounts and OUs.

5. **Create and Attach a Custom SCP**:
   - Create a new SCP named "RequireT2Micro" that only allows launching T2 micro instances. Attach this policy to "ou1".

6. **Test the SCP**:
   - Switch roles into the DEV account using the "OrganizationAccountAccessRole".
   - Attempt to launch an EC2 instance of type T2 micro (which should succeed) and another type (which should fail, demonstrating the SCP's restriction).

7. **Switch Back to Original Account**:
   - After testing, switch back to the original management account.

The demonstration showcases how SCPs can effectively control and restrict API actions within specific AWS accounts, ensuring compliance with organizational policies.
=========================================================================================
# 8.Directory Services & Federation

In this lesson, you learn about AWS directory services and federation. The key points are:
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/5f85ff0f-f6f6-4d9a-91d3-ae305f6ed1fa)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/e77b8cc3-3d40-4aba-a700-e51984561a36)

1. **AWS Managed Microsoft Active Directory**:
   - This is a managed implementation of Microsoft AD on Windows server in AWS.
   - It provides highly available domain controllers (DCs).
   - You can connect your on-premises AD to AWS AD via VPN or direct connect, establishing a trust relationship.
   - Supports secure connections for Amazon EC2 Linux and Windows instances, Azure AD, and Office 365.
   - Allows for group policy application, single sign-on (SSO) to apps and services, and multi-factor authentication.
   - Suitable for organizations with over 5000 users or needing trust relationships with on-premises AD.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/1a01a6af-6311-430c-9007-faa4f08b5f39)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/860615a0-dd34-4497-8668-dbffa009576c)

2. **AD Connector**:
   - Links on-premises AD with AWS, enabling AWS applications to use on-premises AD credentials.
   - Facilitates seamless joining of Windows EC2 instances to on-premises AD.
   - Best for organizations preferring to use their existing AD with AWS services.
   - Comes in small (up to 500 users) and large (up to 5000 users) sizes, requiring VPN or direct connect.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/ce6e049e-a2c7-4f1b-bb9e-8ae1cb16c054)

3. **Identity Federation using SAML 2.0**:
   - Allows users to authenticate through on-premises AD to access AWS resources.
   - Uses Active Directory Federation Services (ADFS) to authenticate users and generate SAML assertions.
   - These assertions are used with AWS Security Token Service (STS) to obtain temporary credentials for accessing AWS services.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/0c67dcf8-4aed-4f67-aff1-5c872b501632)

4. **Web Identity Federation**:
   - Primarily used for mobile applications, allowing authentication through social identity providers (Amazon, Google, Facebook).
   - Utilizes STS to provide temporary security credentials for accessing AWS services.
   - AWS recommends using Cognito for web identity federation.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/d8e935b6-76a9-4350-9700-87c92c9eb2f0)

5. **IAM Identity Center (formerly AWS SSO)**:
   - Provides centralized permissions management and SSO.
   - Can integrate with various identity sources such as IAM Identity Center directory, Active Directory, and SAML 2.0 providers.
   - Enables SSO for AWS accounts and common business applications (e.g., Office 365, G Suite).
   - Allows users to log in with one set of credentials to access multiple resources.

This lesson covers how to set up and use these services to manage and federate identities within AWS, enabling secure and efficient access to AWS resources and applications.
========================================================================================
# 9.Amazon Inspector & Trusted Advisor

In this lesson, you learn about Amazon Inspector and AWS Trusted Advisor services.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/cbe5287a-2026-4642-b8c1-4d526f2999e1)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/5158ad82-9229-44e4-b7c8-366e22159e27)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/1b91a23d-6db8-4f1d-8b67-56b56082eea2)

1. **Amazon Inspector**:
   - **Purpose**: Runs security assessments on EC2 instances to identify vulnerabilities and exposures.
   - **Assessments**:
     - **Network Assessments**: Analyzes network configurations to identify reachable ports from outside the VPC. It does not require an agent.
     - **Host Assessments**: Identifies vulnerable software (CVEs) and checks compliance with CIS benchmarks. Requires an agent on the EC2 instances.
   - **Configuration**: Can be scheduled, and host assessments use the Systems Manager Run Command for agent installation.
   - **Pricing**: Based on the number of instance assessments.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/943711be-5844-40f8-affa-82f2e4a9d40b)

2. **AWS Trusted Advisor**:
   - **Purpose**: Provides real-time guidance to optimize AWS environments, focusing on cost reduction, performance improvement, and security enhancement.
   - **Areas of Guidance**:
     - **Cost Optimization**: Identifies potential savings.
     - **Performance**: Recommends ways to improve performance.
     - **Security**: Highlights security best practices.
     - **Fault Tolerance**: Advises on increasing fault tolerance.
     - **Service Limits**: Warns about approaching service limits.

Overall, these tools help ensure the security, efficiency, and cost-effectiveness of your AWS infrastructure.
========================================================================================
# 10.Encryption Primer

In this lesson, the focus is on the basics of encryption, covering the differences between various types of encryption used in AWS. The key points are:
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/0bdcca45-d6b0-4739-be64-b580ba981be5)
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/4c5fed22-feee-4ab8-ad07-27cee1b378c3)

1. **Encryption in Transit vs. Encryption at Rest**:
   - **Encryption in Transit**: Encrypts data as it traverses a network, such as through an HTTPS connection. The data is encrypted while being transmitted, but may not be encrypted once it reaches its destination.
   - **Encryption at Rest**: Encrypts the actual data itself when it is stored. For example, data stored in Amazon S3 can be encrypted at rest.
![image](https://github.com/Mohanakri/AWS_SOA-Admin/assets/96922237/37588c53-f8e5-4c05-ba2b-2dd3933d5f9f)

2. **Asymmetric vs. Symmetric Encryption**:
   - **Asymmetric Encryption (Public Key Cryptography)**: Involves a pair of keys—public and private. Data encrypted with the public key can only be decrypted with the private key, and vice versa. Examples include SSL/TLS and SSH.
   - **Symmetric Encryption**: Uses a single key for both encryption and decryption. The same key is used for both processes, unlike asymmetric encryption.

Understanding these fundamental concepts helps in grasping how AWS services like KMS keys, Cloud HSM, and AWS Certificate Manager utilize encryption.
========================================================================================
# 11.Key Management Service (KMS)

